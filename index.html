<!DOCTYPE html><html lang="vi"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Garden Moon</title><link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet"><link href="styles.css" rel="stylesheet"><style> /* Custom styles for project link buttons */ .project-links .btn-group { border-radius: 8px; overflow: hidden; } .project-links .btn { border: none; font-weight: 500; transition: all 0.3s ease; min-width: 80px; } .project-links .btn:hover { transform: translateY(-2px); box-shadow: 0 4px 8px rgba(0,0,0,0.2) !important; } .project-links .btn:active { transform: translateY(0); } .project-links .btn-primary { background: linear-gradient(135deg, #007bff, #0056b3); } .project-links .btn-success { background: linear-gradient(135deg, #28a745, #1e7e34); } .project-links .btn-warning { background: linear-gradient(135deg, #ffc107, #e0a800); color: #212529; } .project-links .btn i { font-size: 0.9em; } /* Responsive adjustments */ @media (max-width: 768px) { .project-links .btn { min-width: 60px; padding: 0.375rem 0.5rem; } .project-links .btn i { font-size: 0.8em; } } /* Animation for button appearance */ .project-links .btn { animation: fadeInUp 0.5s ease-out; } @keyframes fadeInUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } } /* RULE TEAM Button Styles - Rainbow Theme */ .rainbow-btn { background: linear-gradient(45deg, #ff0000, #ff7f00, #ffff00, #00ff00, #0000ff, #4b0082, #9400d3); background-size: 400% 400%; border: none; border-radius: 25px; padding: 10px 25px; font-weight: 700; color: white; text-shadow: 2px 2px 4px rgba(0,0,0,0.8); transition: all 0.5s ease; animation: rainbow-shift 3s ease-in-out infinite; box-shadow: 0 4px 15px rgba(0,0,0,0.3); position: relative; overflow: hidden; } .rainbow-btn::before { content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: linear-gradient(45deg, #ff0000, #ff7f00, #ffff00, #00ff00, #0000ff, #4b0082, #9400d3); background-size: 400% 400%; border-radius: 25px; z-index: -1; animation: rainbow-shift 3s ease-in-out infinite; } .rainbow-btn span { background: linear-gradient(45deg, #ff0000, #ff7f00, #ffff00, #00ff00, #0000ff, #4b0082, #9400d3); background-size: 400% 400%; -webkit-background-clip: text; background-clip: text; color: transparent; animation: rainbow-shift 3s ease-in-out infinite; position: relative; z-index: 2; } .rainbow-btn:hover { transform: translateY(-3px) scale(1.05); box-shadow: 0 8px 25px rgba(0,0,0,0.4); text-decoration: none; } .rainbow-btn:hover span { animation: rainbow-shift 1.5s ease-in-out infinite; } .rainbow-btn:active { transform: translateY(-1px) scale(1.02); } @keyframes rainbow-shift { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } } /* Responsive adjustments for RULE TEAM button */ @media (max-width: 768px) { .rainbow-btn { padding: 8px 20px !important; font-size: 0.9rem; } .rainbow-btn i { font-size: 0.8rem; } } </style></head><body><!-- Navigation --><nav class="navbar navbar-expand-lg navbar-dark bg-primary"><div class="container"><a class="navbar-brand" href="#"><i class="fas fa-project-diagram me-2"></i> Bảng DL Garden Moon </a><!-- RULE TEAM Button --><div class="navbar-nav me-auto"><a class="nav-link btn rainbow-btn me-2" href="rule-team.html" target="_blank"><i class="fas fa-book-open me-2"></i><strong><span>RULE TEAM</span></strong></a></div><div class="navbar-nav ms-auto"><div class="nav-item dropdown"><a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button" data-bs-toggle="dropdown"><i class="fas fa-user me-1"></i><span id="currentUser">Khách</span></a><ul class="dropdown-menu"><li><a class="dropdown-item" href="#" onclick="showLoginModal()">Đăng nhập</a></li><li><hr class="dropdown-divider"></li><li><a class="dropdown-item" href="#" onclick="logout()">Đăng xuất</a></li></ul></div></div></div></nav><!-- Login Message (hidden by default) --><div id="loginMessage" class="container mt-5" style="display: none;"><!-- Content will be dynamically inserted by JavaScript --></div><!-- Main Content --><div id="mainContent" class="container-fluid mt-4"><div class="row"><!-- Left Sidebar - Leaderboard --><div class="col-lg-2 col-md-3 mb-4"><div class="leaderboard-sidebar"><!-- All-time Leaderboard --><div class="card leaderboard-card mb-3"><div class="card-header leaderboard-header"><h6 class="mb-0"><i class="fas fa-trophy me-2"></i> Bảng xếp hạng toàn thời gian </h6><small class="text-muted">TOP 5</small></div><div class="card-body p-0"><div id="allTimeLeaderboard" class="leaderboard-list"><!-- Will be populated by JavaScript --></div></div></div><!-- Monthly Leaderboard --><div class="card leaderboard-card"><div class="card-header leaderboard-header"><h6 class="mb-0"><i class="fas fa-calendar-alt me-2"></i> Bảng xếp hạng tháng </h6><small class="text-muted">TOP 10</small></div><div class="card-body p-0"><div id="monthlyLeaderboard" class="leaderboard-list"><!-- Will be populated by JavaScript --></div></div></div></div></div><!-- Main Content Area --><div class="col-lg-8 col-md-6"><!-- Dashboard --><div id="dashboard" class="row"><div class="col-md-3"><div class="card text-center mb-3"><div class="card-body"><i class="fas fa-project-diagram fa-2x text-primary mb-2"></i><h5 class="card-title">Tổng Dự án</h5><h3 id="totalProjects">0</h3></div></div></div><div class="col-md-3"><div class="card text-center mb-3"><div class="card-body"><i class="fas fa-tasks fa-2x text-warning mb-2"></i><h5 class="card-title">Tổng Công việc</h5><h3 id="totalTasks">0</h3></div></div></div><div class="col-md-3"><div class="card text-center mb-3"><div class="card-body"><i class="fas fa-play-circle fa-2x text-success mb-2"></i><h5 class="card-title">Đang hoạt động</h5><h3 id="activeProjects">0</h3></div></div></div><div class="col-md-3"><div class="card text-center mb-3"><div class="card-body"><i class="fas fa-check-circle fa-2x text-info mb-2"></i><h5 class="card-title">Hoàn thành</h5><h3 id="completedProjects">0</h3></div></div></div></div><!-- Action Buttons --><div class="mb-3"><button class="btn btn-primary" id="addProjectBtn" onclick="showAddProjectModal()" style="display: none;"><i class="fas fa-plus"></i> Thêm Truyện </button><button class="btn btn-success" id="addTaskBtn" onclick="showAddTaskModal()" style="display: none;"><i class="fas fa-plus"></i> Thêm Deadline </button><button class="btn btn-info" id="viewEmployeesBtn" onclick="showEmployeesList()" style="display: none;"><i class="fas fa-users"></i> Xem Nhân viên </button><button class="btn btn-warning" id="viewActivityHistoryBtn" onclick="showActivityHistoryView()" style="display: none;"><i class="fas fa-history"></i> Lịch sử hoạt động </button><button class="btn btn-info" id="guestContentBtn" onclick="openGuestContentPage()" style="display: none;"><i class="fas fa-share-alt"></i> Bài gửi khách </button><button class="btn btn-secondary" onclick="refreshData()"><i class="fas fa-sync-alt"></i> Làm mới </button><button class="btn btn-primary" id="rateMembersBtn" onclick="showRateMembersModal()" style="display: none;"><i class="fas fa-star"></i> Rate Thành viên </button></div><!-- Project Filters --><div class="row mb-3"><div class="col-md-12"><div class="card"><div class="card-body"><div class="row"><div class="col-md-4"><label class="form-label">Trạng thái dự án:</label><select class="form-select" id="projectStatusFilter"><option value="">Tất cả</option><option value="active">Đang hoạt động</option><option value="paused">Tạm dừng</option><option value="completed">Hoàn thành</option></select></div><div class="col-md-4"><label class="form-label">Người quản lý:</label><select class="form-select" id="managerFilter"><option value="">Tất cả</option></select></div><div class="col-md-4"><label class="form-label">&nbsp;</label><button class="btn btn-secondary w-100" onclick="applyProjectFilters()"><i class="fas fa-filter me-1"></i>Lọc </button></div></div></div></div></div></div><!-- Projects View --><div id="projectsView"><!-- Projects Table --><div class="row"><div class="col-12"><div class="card"><div class="card-header"><h5 class="mb-0"><i class="fas fa-project-diagram me-2"></i> Danh sách Dự án </h5></div><div class="card-body"><div class="table-responsive"><table class="table table-hover" id="projectsTable"><thead class="table-dark"><tr><th>ID</th><th>Tên Truyện</th><th>Mô tả</th><th>Trạng thái</th><th>Người quản lý</th><th>Ngày tạo</th><th>Số công việc</th><th>Thao tác</th></tr></thead><tbody id="projectsTableBody"><!-- Data will be loaded here --></tbody></table></div></div></div></div></div></div><!-- Tasks View --><div id="tasksView" style="display: none;"><!-- Back Button --><div class="mb-3"><button class="btn btn-secondary" onclick="showProjectsView()"><i class="fas fa-arrow-left me-2"></i>Quay lại danh sách dự án </button></div><!-- Project Info --><div class="row mb-3"><div class="col-12"><div class="card"><div class="card-header"><div class="d-flex justify-content-between align-items-center"><h5 class="mb-0"><i class="fas fa-tasks me-2"></i> Deadline trong truyện: <span id="currentProjectName">Dự án</span></h5><div class="project-links"><div class="btn-group" role="group" aria-label="Project Links"><button class="btn btn-primary btn-sm me-1 shadow-sm" id="storyLinkBtn" onclick="openStoryLink()" style="display: none;" title="Mở link truyện"><i class="fas fa-book-open me-1"></i><span class="d-none d-md-inline">Truyện</span></button><button class="btn btn-success btn-sm me-1 shadow-sm" id="ruleLinkBtn" onclick="openRuleLink()" style="display: none;" title="Mở link rule"><i class="fas fa-gavel me-1"></i><span class="d-none d-md-inline">Rule</span></button><button class="btn btn-warning btn-sm shadow-sm" id="bnvLinkBtn" onclick="openBnvLink()" style="display: none;" title="Mở link BNV"><i class="fas fa-file-alt me-1"></i><span class="d-none d-md-inline">BNV</span></button><button class="btn btn-info btn-sm shadow-sm" id="dialogueLinkBtn" onclick="openDialogueLink()" style="display: none;" title="Mở link thoại"><i class="fas fa-comments me-1"></i><span class="d-none d-md-inline">Thoại</span></button></div></div></div></div><div class="card-body"><!-- Task Type Tabs --><ul class="nav nav-tabs mb-3" id="taskTypeTabs" role="tablist"><li class="nav-item" role="presentation"><button class="nav-link active" id="rv-tab" data-bs-toggle="tab" data-bs-target="#rv-tasks" type="button" role="tab" aria-controls="rv-tasks" aria-selected="true" onclick="switchTaskType('rv')"><i class="fas fa-eye me-2"></i>Deadline Review </button></li><li class="nav-item" role="presentation"><button class="nav-link" id="beta-tab" data-bs-toggle="tab" data-bs-target="#beta-tasks" type="button" role="tab" aria-controls="beta-tasks" aria-selected="false" onclick="switchTaskType('beta')"><i class="fas fa-code me-2"></i>Deadline Beta </button></li></ul><!-- Tab Content --><div class="tab-content" id="taskTypeTabContent"><!-- RV Tasks Tab --><div class="tab-pane fade show active" id="rv-tasks" role="tabpanel" aria-labelledby="rv-tab"><!-- Task Filters --><div class="row mb-3" id="taskFiltersRow"><div class="col-md-4"><label class="form-label">Lọc theo trạng thái:</label><select class="form-select" id="taskStatusFilter" onchange="renderTasksTable()"><option value="">Tất cả</option><option value="pending">Chờ thực hiện</option><option value="in-progress">Đang thực hiện</option><option value="completed">Hoàn thành</option><option value="overdue">Quá hạn</option></select></div><div class="col-md-4"><label class="form-label">Lọc theo người thực hiện:</label><select class="form-select" id="taskAssigneeFilter" onchange="renderTasksTable()"><option value="">Tất cả</option><!-- Nhân viên sẽ được render bằng JS --></select></div></div><div class="table-responsive"><table class="table table-hover" id="tasksTable"><thead class="table-dark"><tr><th>Deadline</th><th>Tên Chap</th><th>Trạng thái</th><th>Mức ưu tiên</th><th>Nội dung Review</th><th>Số chữ thoại</th><th>Số chữ tổng</th><th>Số chữ RV</th><th>Thành tiền</th><th>Người thực hiện</th><th>Ghi chú</th><th>Thao tác</th></tr></thead><tbody id="tasksTableBody"><!-- Tasks will be loaded here --></tbody></table></div></div><!-- Beta Tasks Tab --><div class="tab-pane fade" id="beta-tasks" role="tabpanel" aria-labelledby="beta-tab"><!-- Beta Task Filters --><div class="row mb-3" id="betaTaskFiltersRow"><div class="col-md-4"><label class="form-label">Lọc theo trạng thái:</label><select class="form-select" id="betaTaskStatusFilter" onchange="renderBetaTasksTable()"><option value="">Tất cả</option><option value="pending">Chờ thực hiện</option><option value="in-progress">Đang thực hiện</option><option value="completed">Hoàn thành</option><option value="overdue">Quá hạn</option></select></div><div class="col-md-4"><label class="form-label">Lọc theo người thực hiện:</label><select class="form-select" id="betaTaskAssigneeFilter" onchange="renderBetaTasksTable()"><option value="">Tất cả</option><!-- Nhân viên sẽ được render bằng JS --></select></div></div><div class="table-responsive"><table class="table table-hover" id="betaTasksTable"><thead class="table-dark"><tr><th>Deadline</th><th>Tên Chap</th><th>Trạng thái</th><th>Link RV</th><th>Link Beta</th><th>Số chữ RV</th><th>Số chữ Beta</th><th>Thành tiền</th><th>Người thực hiện</th><th>Ghi chú</th><th>Thao tác</th></tr></thead><tbody id="betaTasksTableBody"><!-- Beta tasks will be loaded here --></tbody></table></div></div></div></div></div></div></div></div></div><!-- Right Sidebar - Notifications --><div class="col-lg-2 col-md-3 mb-4"><div class="notifications-sidebar"><!-- Team Announcements --><div class="card notification-card mb-3"><div class="card-header notification-header"><h6 class="mb-0"><i class="fas fa-bullhorn me-2"></i> Thông báo Team </h6><button class="btn btn-sm btn-outline-primary" id="editAnnouncementBtn" onclick="editAnnouncement()" style="display: none;"><i class="fas fa-edit"></i></button></div><div id="systemAnnouncement" class="announcement-content"><p class="text-muted mb-0">Chưa có thông báo nào</p></div><div id="announcementEditForm" class="announcement-edit-form" style="display: none;"><textarea class="form-control mb-2" id="announcementText" rows="3" placeholder="Nhập thông báo mới..."></textarea><div class="d-flex gap-2"><button class="btn btn-sm btn-primary" onclick="saveAnnouncement()">Lưu</button><button class="btn btn-sm btn-secondary" onclick="cancelEditAnnouncement()">Hủy</button></div></div></div><!-- Recent Notifications --><div class="card notification-card mb-3"><div class="card-header notification-header"><h6 class="mb-0"><i class="fas fa-bell me-2"></i> Thông báo nhận Deadline </h6></div><div class="card-body p-0"><div id="recentNotifications" class="notification-list"><!-- Will be populated by JavaScript --></div></div></div><!-- Upcoming Deadlines --><div class="card notification-card"><div class="card-header notification-header"><h6 class="mb-0"><i class="fas fa-clock me-2"></i> Deadline sắp đến </h6></div><div class="card-body p-0"><div id="upcomingDeadlines" class="deadline-list"><!-- Will be populated by JavaScript --></div></div></div></div></div></div></div><!-- Login Modal --><div class="modal fade" id="loginModal" tabindex="-1"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><h5 class="modal-title">Đăng nhập</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><form id="loginForm"><div class="mb-3"><label class="form-label">Email:</label><input type="email" class="form-control" id="loginEmail" required></div><div class="mb-3"><label class="form-label">Mật khẩu:</label><input type="password" class="form-control" id="loginPassword" required></div></form></div><div class="modal-footer"><button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Hủy</button><button type="button" class="btn btn-primary" onclick="login()">Đăng nhập</button></div></div></div></div><!-- Add/Edit Project Modal --><div class="modal fade" id="projectModal" tabindex="-1"><div class="modal-dialog modal-lg"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="projectModalTitle">Thêm Truyện</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><form id="projectForm"><input type="hidden" id="projectId"><div class="row"><div class="col-md-4"><div class="mb-3"><label class="form-label">Tên Truyện:</label><input type="text" class="form-control" id="projectName" required></div></div><div class="col-md-4"><div class="mb-3"><label class="form-label">Trạng thái:</label><select class="form-select" id="projectStatus" required><option value="active">Đang hoạt động</option><option value="paused">Tạm dừng</option><option value="completed">Hoàn thành</option></select></div></div><div class="col-md-4"><div class="mb-3"><label class="form-label">Người quản lý:</label><select class="form-select" id="projectManager"><option value="">Chọn người quản lý...</option></select></div></div></div><div class="mb-3"><label class="form-label">Mô tả:</label><textarea class="form-control" id="projectDescription" rows="3"></textarea></div><!-- Link fields --><div class="row"><div class="col-md-4"><div class="mb-3"><label class="form-label">Link truyện:</label><input type="url" class="form-control" id="projectStoryLink" placeholder="https://..."></div></div><div class="col-md-4"><div class="mb-3"><label class="form-label">Link Rule:</label><input type="url" class="form-control" id="projectRuleLink" placeholder="https://..."></div></div><div class="col-md-4"><div class="mb-3"><label class="form-label">Link BNV:</label><input type="url" class="form-control" id="projectBnvLink" placeholder="https://..."></div></div><div class="col-md-4"><div class="mb-3"><label class="form-label">Link Thoại:</label><input type="url" class="form-control" id="projectDialogueLink" placeholder="https://..."></div></div></div><!-- Bulk Rate Settings --><div class="card mt-3"><div class="card-header"><h6 class="mb-0">Cài đặt Rate hàng loạt</h6></div><div class="card-body"><div class="row"><div class="col-md-6"><div class="mb-3"><label class="form-label">Rate RV (VNĐ/1000 chữ):</label><input type="number" class="form-control" id="projectRVRate" min="0" step="0.01" placeholder="Nhập rate RV..."></div></div><div class="col-md-6"><div class="mb-3"><label class="form-label">Rate Beta (VNĐ/1000 chữ):</label><input type="number" class="form-control" id="projectBetaRate" min="0" step="0.01" placeholder="Nhập rate Beta..."></div></div></div><div class="row"><div class="col-md-6"><div class="mb-3"><label class="form-label">Áp dụng cho:</label><select class="form-select" id="projectRateTarget"><option value="all">Tất cả nhân viên</option><option value="individual">Từng nhân viên</option></select></div></div><div class="col-md-6" id="individualEmployeeSection" style="display: none;"><div class="mb-3"><label class="form-label">Chọn nhân viên:</label><select class="form-select" id="projectEmployeeSelect" multiple><!-- Will be populated dynamically --></select></div></div></div><div class="mt-2"><button type="button" class="btn btn-outline-primary btn-sm" onclick="applyBulkRates()"><i class="bi bi-arrow-down-circle"></i> Áp dụng Rate </button><small class="text-muted ms-2">Áp dụng rate cho các task hiện có trong dự án</small></div></div></div></form></div><div class="modal-footer"><button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Hủy</button><button type="button" class="btn btn-primary" onclick="saveProject()">Lưu</button></div></div></div></div><!-- Add/Edit Task Modal --><div class="modal fade" id="taskModal" tabindex="-1"><div class="modal-dialog modal-lg"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="taskModalTitle">Thêm Deadline</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><form id="taskForm"><input type="hidden" id="taskId"><input type="hidden" id="taskProjectId"><div class="row"><div class="col-md-6"><div class="mb-3"><label class="form-label">Tên Chap:</label><input type="text" class="form-control" id="taskName" required></div></div><div class="col-md-6"><div class="mb-3"><label class="form-label">Deadline:</label><input type="datetime-local" class="form-control" id="taskDeadline" required></div></div></div><div class="row align-items-center mb-3"><div class="col-md-4"><div class="form-check"><input class="form-check-input" type="checkbox" id="batchCreateCheckbox" onchange="toggleBatchCreate()"><label class="form-check-label" for="batchCreateCheckbox">Tạo hàng loạt</label></div></div><div class="col-md-4" id="batchCountGroup" style="display:none;"><label class="form-label">Số lượng:</label><input type="number" class="form-control" id="batchCount" min="2" value="2"></div><div class="col-md-4" id="batchStartGroup" style="display:none;"><label class="form-label">Số bắt đầu:</label><input type="number" class="form-control" id="batchStart" min="1" value="1"></div></div><div class="row batch-hide"><div class="col-md-6"><div class="mb-3"><label class="form-label">Nội dung Task Review:</label><div class="d-flex gap-2"><button type="button" class="btn btn-outline-primary" id="openReviewInputBtn" onclick="openReviewInputPage()"><i class="fas fa-edit me-2"></i>Nhập nội dung Review </button></div></div></div><div class="col-md-6"><div class="mb-3"><label class="form-label">Link Beta:</label><input type="url" class="form-control" id="taskBetaLink" placeholder="https://..."></div></div></div><div class="row batch-hide"><div class="col-md-6"><div class="mb-3"><label class="form-label">Người thực hiện:</label><select class="form-select" id="taskAssignee"><option value="">Chọn người thực hiện (tùy chọn)</option><!-- Will be populated with employees --></select></div></div></div><div class="row batch-hide"><div class="col-md-4"><div class="mb-3"><label class="form-label">Số chữ thoại:</label><input type="number" class="form-control" id="taskDialogueChars" min="0"></div></div><div class="col-md-4"><div class="mb-3"><label class="form-label">Số chữ tổng:</label><input type="number" class="form-control" id="taskTotalChars" min="0" readonly></div></div><div class="col-md-4"><div class="mb-3"><label class="form-label">Số chữ RV (tự động tính):</label><input type="number" class="form-control" id="taskRVChars" min="0" readonly></div></div><div class="col-md-4"><div class="mb-3"><label class="form-label">Số chữ Beta:</label><input type="number" class="form-control" id="taskBetaChars" min="0" readonly></div></div></div><div class="row batch-hide"><div class="col-md-4"><div class="mb-3"><label class="form-label">Rate RV (VNĐ/1000 chữ):</label><input type="number" class="form-control" id="taskRate" min="0" step="0.01"></div></div><div class="col-md-4"><div class="mb-3"><label class="form-label">Rate Beta (VNĐ/1000 chữ):</label><input type="number" class="form-control" id="taskBetaRate" min="0" step="0.01"></div></div><div class="col-md-4"><div class="mb-3"><label class="form-label">Độ ưu tiên: <span id="priorityNote" class="text-muted small" style="display: none;">(Chỉ quản lý mới có thể thay đổi)</span></label><select class="form-select" id="taskPriority" required><option value="low">Thấp</option><option value="medium">Trung bình</option><option value="high">Cao</option><option value="urgent">Khẩn cấp</option></select></div></div></div><div class="mb-3 batch-hide"><label class="form-label">Mô tả:</label><textarea class="form-control" id="taskDescription" rows="2"></textarea></div><div class="mb-3 batch-hide"><label class="form-label">Ghi chú RV:</label><textarea class="form-control" id="taskNotes" rows="2" placeholder="Ghi chú của reviewer..."></textarea></div><div class="mb-3 batch-hide" id="betaNotesField" style="display: none;"><label class="form-label">Ghi chú Beta:</label><textarea class="form-control" id="taskBetaNotes" rows="2" placeholder="Ghi chú của beta..."></textarea></div><div class="mb-3" id="taskStatusField" style="display: none;"><label class="form-label">Trạng thái:</label><select class="form-select" id="taskStatus"><option value="pending">Chờ thực hiện</option><option value="in-progress">Đang thực hiện</option><option value="completed">Hoàn thành</option><option value="overdue">Quá hạn</option></select></div></form></div><div class="modal-footer"><button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Hủy</button><button type="button" class="btn btn-primary" onclick="saveTask()">Lưu</button></div></div></div></div><!-- Project Report Modal --><div class="modal fade" id="projectReportModal" tabindex="-1"><div class="modal-dialog modal-xl"><div class="modal-content"><div class="modal-header"><h5 class="modal-title">Báo cáo dự án: <span id="reportProjectName">Dự án</span></h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><!-- Employee Filter --><div class="row mb-3"><div class="col-md-4"><label class="form-label">Lọc theo nhân viên:</label><select class="form-select" id="reportEmployeeFilter" onchange="filterReportData()"><option value="">Tất cả nhân viên</option><!-- Employees will be populated here --></select></div></div><!-- Report Summary --><div class="row mb-4"><div class="col-md-3"><div class="card bg-primary text-white"><div class="card-body text-center"><h4 id="totalTasksCount">0</h4><p class="mb-0">Tổng công việc</p></div></div></div><div class="col-md-3"><div class="card bg-success text-white"><div class="card-body text-center"><h4 id="totalRVChars">0</h4><p class="mb-0">Tổng chữ RV</p></div></div></div><div class="col-md-3"><div class="card bg-info text-white"><div class="card-body text-center"><h4 id="totalBetaChars">0</h4><p class="mb-0">Tổng chữ Beta</p></div></div></div><div class="col-md-3"><div class="card bg-warning text-white"><div class="card-body text-center"><h4 id="totalMoney">0 VNĐ</h4><p class="mb-0">Tổng tiền</p></div></div></div></div><!-- Detailed Report Table --><div class="table-responsive"><table class="table table-striped" id="reportTable"><thead class="table-dark"><tr><th>Nhân viên</th><th>Số công việc</th><th>Chữ RV</th><th>Chữ Beta</th><th>Tiền RV</th><th>Tiền Beta</th><th>Tổng tiền</th></tr></thead><tbody id="reportTableBody"><!-- Report data will be loaded here --></tbody></table></div></div><div class="modal-footer"><button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Đóng</button><button type="button" class="btn btn-primary" onclick="exportReportToCSV()"><i class="fas fa-download me-1"></i>Xuất CSV </button></div></div></div></div><!-- Employees Modal --><div class="modal fade" id="employeesModal" tabindex="-1"><div class="modal-dialog modal-lg"><div class="modal-content"><div class="modal-header"><h5 class="modal-title">Danh sách Nhân viên</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="table-responsive"><table class="table table-striped"><thead><tr><th>ID</th><th>Tên</th><th>Email</th><th>Vai trò</th></tr></thead><tbody id="employeesTableBody"><!-- Employees will be loaded here --></tbody></table></div></div><div class="modal-footer"><button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Đóng</button></div></div></div></div><!-- Modal Download Beta Files --><div class="modal fade" id="downloadBetaModal" tabindex="-1"><div class="modal-dialog modal-lg"><div class="modal-content"><div class="modal-header"><h5 class="modal-title">Tải File - <span id="downloadProjectName"></span></h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><!-- Tùy chọn tải --><div class="row mb-3"><div class="col-md-3"><label class="form-label">Loại file:</label><select class="form-select" id="fileType" onchange="onFileTypeChange()"><option value="beta">Tải file Beta</option><option value="review">Tải file Review</option></select></div><div class="col-md-3"><label class="form-label">Chế độ tải:</label><select class="form-select" id="downloadMode"><option value="batch">Tải hàng loạt (tất cả)</option><option value="individual">Tải từng file lẻ</option></select></div><div class="col-md-3"><label class="form-label">Tùy chọn gộp file:</label><select class="form-select" id="mergeOption"><option value="merge">Gộp thành 1 file</option><option value="separate">Tải file riêng biệt</option></select></div><div class="col-md-3"><label class="form-label">Định dạng file:</label><select class="form-select" id="fileFormat"><option value="doc">Word (.doc)</option><option value="txt">Text (.txt)</option></select></div></div><!-- Danh sách file beta --><div class="table-responsive"><table class="table table-sm" id="betaFilesTable"><thead><tr><th><input type="checkbox" id="selectAllBetaFiles"></th><th>Tên Chap</th><th>Người thực hiện</th><th>Trạng thái</th><th>Ngày cập nhật</th></tr></thead><tbody id="betaFilesTableBody"><!-- Sẽ được populate bằng JS --></tbody></table></div></div><div class="modal-footer"><button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Hủy</button><button type="button" class="btn btn-primary" onclick="executeDownload()"><i class="fas fa-download"></i> Tải File </button></div></div></div></div><!-- Rate Members Modal --><div class="modal fade" id="rateMembersModal" tabindex="-1"><div class="modal-dialog modal-xl"><div class="modal-content"><div class="modal-header"><h5 class="modal-title"><i class="fas fa-star me-2"></i>Quản lý Rate Thành viên </h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><!-- Rate Management Tabs --><ul class="nav nav-tabs mb-3" id="rateManagementTabs" role="tablist"><li class="nav-item" role="presentation"><button class="nav-link active" id="employee-rates-tab" data-bs-toggle="tab" data-bs-target="#employee-rates" type="button" role="tab"><i class="fas fa-users me-2"></i>Rate Nhân viên </button></li><li class="nav-item" role="presentation"><button class="nav-link" id="project-rates-tab" data-bs-toggle="tab" data-bs-target="#project-rates" type="button" role="tab"><i class="fas fa-project-diagram me-2"></i>Rate Dự án </button></li><li class="nav-item" role="presentation"><button class="nav-link" id="bulk-rates-tab" data-bs-toggle="tab" data-bs-target="#bulk-rates" type="button" role="tab"><i class="fas fa-cogs me-2"></i>Cài đặt Hàng loạt </button></li></ul><!-- Tab Content --><div class="tab-content" id="rateManagementTabContent"><!-- Employee Rates Tab --><div class="tab-pane fade show active" id="employee-rates" role="tabpanel"><div class="row mb-3"><div class="col-md-6"><h6>Rate mặc định của nhân viên</h6><p class="text-muted small">Rate này sẽ được áp dụng khi không có rate riêng cho dự án</p></div><div class="col-md-6 text-end"><button class="btn btn-success btn-sm" onclick="addNewEmployeeRate()" id="addEmployeeRateBtn" style="display: none;"><i class="fas fa-plus me-1"></i>Thêm Rate </button></div></div><div class="table-responsive"><table class="table table-striped" id="employeeRatesTable"><thead class="table-dark"><tr><th>Nhân viên</th><th>Rate RV Sẵn Thoại(VNĐ/1000 chữ)</th><th>Rate RV Không thoại (VNĐ/1000 chữ)</th><th>Ngày cập nhật</th><th>Thao tác</th></tr></thead><tbody id="employeeRatesTableBody"><!-- Will be populated by JavaScript --></tbody></table></div></div><!-- Project Rates Tab --><div class="tab-pane fade" id="project-rates" role="tabpanel"><div class="row mb-3"><div class="col-md-6"><h6>Rate mặc định của dự án</h6><p class="text-muted small">Rate này sẽ được áp dụng cho tất cả nhân viên trong dự án (nếu được chọn)</p></div><div class="col-md-6 text-end"><button class="btn btn-success btn-sm" onclick="addNewProjectRate()" id="addProjectRateBtn" style="display: none;"><i class="fas fa-plus me-1"></i>Thêm Rate Dự án </button></div></div><div class="table-responsive"><table class="table table-striped" id="projectRatesTable"><thead class="table-dark"><tr><th>Dự án</th><th>Rate RV (VNĐ/1000 chữ)</th><th>Rate Beta (VNĐ/1000 chữ)</th><th>Ngày cập nhật</th><th>Thao tác</th></tr></thead><tbody id="projectRatesTableBody"><!-- Will be populated by JavaScript --></tbody></table></div></div><!-- Bulk Rates Tab --><div class="tab-pane fade" id="bulk-rates" role="tabpanel"><div class="row mb-3"><div class="col-md-12"><h6>Cài đặt Rate hàng loạt</h6><p class="text-muted small">Áp dụng rate cho nhiều nhân viên hoặc dự án cùng lúc</p></div></div><div class="row"><div class="col-md-6"><div class="card"><div class="card-header"><h6 class="mb-0">Áp dụng cho nhân viên</h6></div><div class="card-body"><div class="mb-3"><label class="form-label">Chọn nhân viên:</label><select class="form-select" id="bulkEmployeeSelect" multiple><!-- Will be populated dynamically --></select></div><div class="mb-3"><label class="form-label">Rate RV (VNĐ/1000 chữ):</label><input type="number" class="form-control" id="bulkEmployeeRVRate" min="0" step="0.01"></div><div class="mb-3"><label class="form-label">Rate Beta (VNĐ/1000 chữ):</label><input type="number" class="form-control" id="bulkEmployeeBetaRate" min="0" step="0.01"></div><button class="btn btn-primary btn-sm" onclick="applyBulkEmployeeRates()"><i class="fas fa-save me-1"></i>Áp dụng </button></div></div></div><div class="col-md-6"><div class="card"><div class="card-header"><h6 class="mb-0">Áp dụng cho dự án</h6></div><div class="card-body"><div class="mb-3"><label class="form-label">Chọn dự án:</label><select class="form-select" id="bulkProjectSelect" multiple><!-- Will be populated dynamically --></select></div><div class="mb-3"><label class="form-label">Rate RV (VNĐ/1000 chữ):</label><input type="number" class="form-control" id="bulkProjectRVRate" min="0" step="0.01"></div><div class="mb-3"><label class="form-label">Rate Beta (VNĐ/1000 chữ):</label><input type="number" class="form-control" id="bulkProjectBetaRate" min="0" step="0.01"></div><button class="btn btn-primary btn-sm" onclick="applyBulkProjectRates()"><i class="fas fa-save me-1"></i>Áp dụng </button></div></div></div></div></div></div></div><div class="modal-footer"><button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Đóng</button></div></div></div></div><!-- Add/Edit Employee Rate Modal --><div class="modal fade" id="employeeRateModal" tabindex="-1"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="employeeRateModalTitle">Thêm Rate Nhân viên</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><form id="employeeRateForm"><input type="hidden" id="employeeRateId"><div class="mb-3"><label class="form-label">Nhân viên:</label><select class="form-select" id="employeeRateEmployeeSelect" required><option value="">Chọn nhân viên...</option></select></div><div class="mb-3"><label class="form-label">Rate RV (VNĐ/1000 chữ):</label><input type="number" class="form-control" id="employeeRateRVRate" min="0" step="0.01" required></div><div class="mb-3"><label class="form-label">Rate Beta (VNĐ/1000 chữ):</label><input type="number" class="form-control" id="employeeRateBetaRate" min="0" step="0.01" required></div></form></div><div class="modal-footer"><button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Hủy</button><button type="button" class="btn btn-primary" onclick="saveEmployeeRate()">Lưu</button></div></div></div></div><!-- Add/Edit Project Rate Modal --><div class="modal fade" id="projectRateModal" tabindex="-1"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="projectRateModalTitle">Thêm Rate Dự án</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><form id="projectRateForm"><input type="hidden" id="projectRateId"><div class="mb-3"><label class="form-label">Dự án:</label><select class="form-select" id="projectRateProjectSelect" required><option value="">Chọn dự án...</option></select></div><div class="mb-3"><label class="form-label">Rate RV (VNĐ/1000 chữ):</label><input type="number" class="form-control" id="projectRateRVRate" min="0" step="0.01" required></div><div class="mb-3"><label class="form-label">Rate Beta (VNĐ/1000 chữ):</label><input type="number" class="form-control" id="projectRateBetaRate" min="0" step="0.01" required></div></form></div><div class="modal-footer"><button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Hủy</button><button type="button" class="btn btn-primary" onclick="saveProjectRate()">Lưu</button></div></div></div></div><!-- Activity History View --><div id="activityHistoryView" style="display: none;"><div class="mb-3"><button class="btn btn-secondary" onclick="showProjectsView()"><i class="fas fa-arrow-left me-2"></i>Quay lại danh sách dự án </button></div><div class="row"><div class="col-12"><div class="card activity-history-card"><div class="card-header"><h5 class="mb-0"><i class="fas fa-history me-2"></i> Lịch sử hoạt động của nhân viên </h5></div><div class="card-body"><!-- Employee Activity Filters --><div class="row mb-3 activity-filters"><div class="col-md-4"><label class="form-label">Lọc theo nhân viên:</label><select class="form-select" id="employeeActivityFilter" onchange="renderActivityHistoryTable()"><option value="">Tất cả nhân viên</option></select></div><div class="col-md-4"><label class="form-label">Lọc theo trạng thái:</label><select class="form-select" id="activityStatusFilter" onchange="renderActivityHistoryTable()"><option value="">Tất cả trạng thái</option><option value="active">Đang hoạt động</option><option value="inactive">Không hoạt động</option><option value="warning">Cần chú ý</option></select></div><div class="col-md-4"><label class="form-label">&nbsp;</label><button class="btn btn-refresh-activity w-100" onclick="refreshActivityHistory()"><i class="fas fa-sync-alt me-1"></i>Làm mới </button></div></div><!-- Activity History Table --><div class="table-responsive"><table class="table table-hover activity-history-table" id="activityHistoryTable"><thead class="table-dark"><tr><th>Nhân viên</th><th>Vai trò</th><th>Task cuối cùng</th><th>Ngày nhận</th><th>Ngày hoàn thành</th><th>Thời gian không hoạt động</th><th>Trạng thái</th><th>Thao tác</th></tr></thead><tbody id="activityHistoryTableBody"><!-- Data will be loaded here --></tbody></table></div></div></div></div></div></div><!-- Toast Notifications --><div class="toast-container position-fixed bottom-0 end-0 p-3"><div id="notificationToast" class="toast" role="alert"><div class="toast-header"><strong class="me-auto" id="toastTitle">Thông báo</strong><button type="button" class="btn-close" data-bs-dismiss="toast"></button></div><div class="toast-body p-0" id="toastMessage"><!-- Toast message will be here --></div></div></div><!-- Supabase SDK --><script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script><script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script><script src="config.js"></script><script src="script.js"></script></body></html>